import{a as T,r as i,z as h,w as x,o as c,c as f,b as d,F as y,e as E,n as H,G as L}from"./basic-DfhHe1pL.js";import{_ as F}from"./index-DQ4QNw3m.js";const V={class:"hinter"},M=["innerHTML","onClick"],I=T({__name:"Hinter",props:{modelValue:{},getList:{type:Function},submit:{type:Function},parseText:{type:Function},meta:{}},setup(_){const l=_,r=i(null);h(()=>{r.value&&l.modelValue&&(console.info(l.modelValue),r.value.innerHTML=l.parseText(l.modelValue))});async function m(e){e.isComposing||L.debounce(async()=>{var a;n.value=await l.getList((a=r.value)==null?void 0:a.innerHTML),n.value.length&&(n.value[0]._sel=!0)},200,"hinterDebounce")}async function g(e){let t,a;switch(e.code){case"ArrowDown":if(e.stopPropagation(),e.preventDefault(),!n.value.length)break;for(t=-1,n.value.forEach((o,u)=>{o._sel&&(t=u)}),a=t+1;a<0;)a+=n.value.length;for(;a>=n.value.length;)a-=n.value.length;n.value.forEach((o,u)=>{o._sel=u==a});break;case"ArrowUp":if(e.stopPropagation(),e.preventDefault(),!n.value.length)break;for(t=0,n.value.forEach((o,u)=>{o._sel&&(t=u)}),a=t-1;a<0;)a+=n.value.length;for(;a>=n.value.length;)a-=n.value.length;n.value.forEach((o,u)=>{o._sel=u==a});break;case"NumpadEnter":case"Enter":if(e.stopPropagation(),e.preventDefault(),!n.value.length||(t=-1,n.value.forEach((o,u)=>{o._sel&&(t=u)}),t==-1))break;const s=n.value[t];p(s);break}}x(()=>l.modelValue,async e=>{console.info(e),v.value=e,r.value&&(r.value.innerHTML=l.parseText(e))});const v=i(null);h(()=>{var e;(e=r.value)==null||e.focus()});const n=i([]);function b(e){return l.parseText?l.parseText(e):e}async function p(e){v.value=null,r.value&&(r.value.innerHTML=""),n.value=[],await l.submit(e,l.meta)}function k(){}function w(){}return(e,t)=>(c(),f("div",V,[d("div",{contenteditable:"true",onInput:m,onKeydown:g,onFocus:w,onBlur:k,ref_key:"editor",ref:r},null,544),d("ul",null,[(c(!0),f(y,null,E(n.value,(a,s)=>(c(),f("li",{key:`hinter_${s}`,innerHTML:b(a),onClick:o=>p(a),class:H({active:a._sel})},null,10,M))),128))])]))}}),D=F(I,[["__scopeId","data-v-1a994bff"]]);export{D as H};
